-- Project utilizes Excel, MySQL, and Taleau
-- Original Excel files downloaded from https://github.com/AlexTheAnalyst/PortfolioProjects/tree/main. Excel file was formated for MySQL import
-- SQL used to clean and analyze data
-- Tableau used visualize data https://public.tableau.com/views/Covid-19First-YearDashboard/Dashboard1?:language=en-US&:sid=&:redirect=auth&:display_count=n&:origin=viz_share_link

-- Create a table for covid deaths data
create table covid_deaths(
iso_code VARCHAR(45),
continent VARCHAR(45),
location VARCHAR(45),
date DATE,
population BIGINT,
total_cases BIGINT,
new_cases BIGINT,
new_cases_smoothed FLOAT,
total_deaths BIGINT,
new_deaths BIGINT,
new_deaths_smoothed FLOAT,
total_cases_per_million FLOAT,
new_cases_per_million FLOAT,
new_cases_smoothed_per_million FLOAT,
total_deaths_per_million FLOAT,
new_deaths_per_million FLOAT,
new_deaths_smoothed_per_million FLOAT,
reproduction_rate FLOAT,
icu_patients BIGINT,
icu_patients_per_million FLOAT,
hosp_patients DOUBLE,
hosp_patients_per_million FLOAT,
weekly_icu_admissions FLOAT,
weekly_icu_admissions_per_million FLOAT,
weekly_hosp_admissions FLOAT,
weekly_hosp_admissions_per_million FLOAT
);

LOAD DATA INFILE 'covid_deaths.csv'
INTO TABLE covid_deaths
FIELDS TERMINATED BY ','
IGNORE 1 LINES;

SELECT*
FROM covid_deaths

-- Create a table for covid vaccinations data
CREATE TABLE covid_vaccinations(
iso_code VARCHAR(45),
continent VARCHAR(45),
location VARCHAR(45),
date DATE,
new_tests BIGINT,
total_tests BIGINT,
total_tests_per_thousand FLOAT,
new_tests_per_thousand FLOAT,
new_tests_smoothed BIGINT,
new_tests_smoothed_per_thousand FLOAT,
positive_rate FLOAT,
tests_per_case FLOAT,
tests_units VARCHAR(45),
total_vaccinations BIGINT,
people_vaccinated BIGINT,
people_fully_vaccinated BIGINT,
new_vaccinations BIGINT,
new_vaccinations_smoothed BIGINT,
total_vaccinations_per_hundred FLOAT,
people_vaccinated_per_hundred FLOAT,
people_fully_vaccinated_per_hundred FLOAT,
new_vaccinations_smoothed_per_million BIGINT,
stringency_index FLOAT,
population_density FLOAT,
median_age FLOAT,
aged_65_older FLOAT,
aged_70_older FLOAT,
gdp_per_capita FLOAT,
extreme_poverty FLOAT,
cardiovasc_death_rate FLOAT,
diabetes_prevalence FLOAT,
female_smokers FLOAT,
male_smokers FLOAT,
handwashing_facilities FLOAT,
hospital_beds_per_thousand FLOAT,
life_expectancy FLOAT,
human_development_index FLOAT
);

LOAD DATA INFILE 'covid_vaccinations.csv'
INTO TABLE covid_vaccinations
FIELDS TERMINATED BY ','
IGNORE 1 LINES;

SELECT*
FROM covid_vaccinations
